<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Will You be my Valentine?</title>
    <link rel="stylesheet" href="valStyle.css" />
</head>
<body>
    <div class="navbar">
        <a href="#home" class="nav-link active" id="homeLink" onclick="setActive(this)">Home</a>
        <a href="#trina" class="nav-link" id="trinaLink" onclick="setActive(this)" style="pointer-events: none; opacity: 0.5;">Trina</a>
    </div>
    
    <div id="home" class="container">
        <div class="content-wrapper">
            <h1 id="question">Will you be my Valentine?</h1>
            <div class="gif-container">
                <div id="gif">
                    <iframe src="https://tenor.com/embed/12962892" width="100%" height="100%" frameborder="0" allowfullscreen></iframe>
                </div>
            </div>
            <div class="buttons">
                <button id="yesBtn" onclick="redirectToTrina()">Yes! üíï</button>
                <button id="noBtn" onclick="handleNoClick()">No</button>
            </div>
        </div>
    </div>
    
    <div id="trina" class="container" style="display: none;">
        <div class="strobe-flash"></div>
        <div class="disco-ball"></div>
        <div class="spotlight spotlight-1"></div>
        <div class="spotlight spotlight-2"></div>
        <div class="spotlight spotlight-3"></div>
        <div class="party-lights"></div>
        <div class="party-lights party-lights-2"></div>
        <div class="content-wrapper celebration-wrapper">
            <h1 class="success-message">Yeeeeey! Thank you Bb I LOVE YOU!! üíïüíï</h1>
            <div class="celebration-container">
                <iframe class="celebration-gif" src="https://tenor.com/embed/22285495" allowfullscreen></iframe>
            </div>
        </div>
    </div>
    
    <script>
        let noClickCount = 0;
        let noBtnContainer = null;

        let celebrationAudio = null;

        function redirectToTrina() {
            window.location.hash = "#trina";
            document.getElementById("trina").style.display = "block";
            document.getElementById("home").style.display = "none";
            
            setActive(document.querySelector("a[href='#trina']"));
            document.getElementById("trinaLink").style.pointerEvents = "auto";
            document.getElementById("trinaLink").style.opacity = "1";
            
            document.getElementById("homeLink").style.pointerEvents = "none";
            document.getElementById("homeLink").style.opacity = "0.5";
            
            resetYesButton();
            
            // Start continuous party effects
            startPartyMode();
            
            // Play celebration music on loop - with mobile support
            if (!celebrationAudio) {
                celebrationAudio = new Audio('celebration-music.mp3');
                celebrationAudio.volume = 0.5;
                celebrationAudio.loop = true;
            }
            // Try to play, with user interaction it should work on mobile
            celebrationAudio.play().catch(err => {
                console.log('Audio play failed:', err);
                // Add touch listener to start audio on first touch for mobile
                document.addEventListener('touchstart', function playOnTouch() {
                    celebrationAudio.play();
                    document.removeEventListener('touchstart', playOnTouch);
                }, { once: true });
            });
        }

        let partyInterval = null;

        function startPartyMode() {
            // Initial confetti burst
            createConfetti();
            
            // Continue creating confetti every 3 seconds
            partyInterval = setInterval(() => {
                createConfetti();
            }, 3000);
        }

        function stopPartyMode() {
            if (partyInterval) {
                clearInterval(partyInterval);
                partyInterval = null;
            }
        }

        function handleNoClick() {
            noClickCount++;
            let yesBtn = document.getElementById("yesBtn");
            let noBtn = document.getElementById("noBtn");
            let questionElement = document.getElementById("question");
            
            // Grow yes button
            let currentSize = parseFloat(window.getComputedStyle(yesBtn).fontSize);
            yesBtn.style.fontSize = (currentSize * 1.3) + "px";
            yesBtn.style.padding = (parseFloat(window.getComputedStyle(yesBtn).paddingTop) * 1.2) + "px " + 
                                   (parseFloat(window.getComputedStyle(yesBtn).paddingLeft) * 1.2) + "px";
            
            // Change question text
            const questions = [
                "Are you really sure?",
                "Are you really really sure?",
                "Think again! Pretty please? ü•∫",
                "Are you absolutely certain?",
                "Last chance to reconsider! üíî"
            ];
            
            if (noClickCount <= questions.length) {
                questionElement.textContent = questions[noClickCount - 1];
            }
            
            // After first click, create the floating button
            if (noClickCount === 1) {
                createFloatingNoButton();
            }
        }

        function createFloatingNoButton() {
            let noBtn = document.getElementById("noBtn");
            let gifContainer = document.getElementById("gif");
            
            // Hide original no button
            noBtn.style.display = "none";
            
            // Clear and hide the main gif
            gifContainer.innerHTML = "";
            gifContainer.style.background = "transparent";
            gifContainer.style.boxShadow = "none";
            
            // Create container for button with duck gif on gif
            noBtnContainer = document.createElement("div");
            noBtnContainer.className = "floating-no-container";
            noBtnContainer.innerHTML = `
                <div class="cat-button-combo">
                    <button class="floating-no-btn">No</button>
                    <div class="running-cat-container">
                        <iframe src="https://tenor.com/embed/4093922059927037978" frameborder="0" allowfullscreen></iframe>
                    </div>
                </div>
            `;
            
            // Add the duck and button to the container
            gifContainer.style.position = "relative";
            gifContainer.appendChild(noBtnContainer);
            
            // Add hover/touch event to the button itself to make it teleport and play quack sound
            const floatingBtn = noBtnContainer.querySelector(".floating-no-btn");
            
            function handleNoButtonInteraction() {
                // Play quack sound
                const quackSound = new Audio('quack.mp3');
                quackSound.volume = 0.6;
                quackSound.play().catch(err => console.log('Quack sound failed:', err));
                
                // Teleport button
                teleportButton();
            }
            
            // Desktop: mouseenter
            floatingBtn.addEventListener("mouseenter", handleNoButtonInteraction);
            
            // Mobile: touchstart (before the button moves)
            floatingBtn.addEventListener("touchstart", (e) => {
                e.preventDefault(); // Prevent default touch behavior
                handleNoButtonInteraction();
            }, { passive: false });
        }

        function teleportButton() {
            if (!noBtnContainer) return;
            
            const gifContainer = document.getElementById("gif");
            const containerRect = gifContainer.getBoundingClientRect();
            
            // Calculate button dimensions (approximate)
            const buttonWidth = 100;
            const buttonHeight = 150; // button + duck height
            
            // Random position within the gif area with padding to stay inside
            const padding = 20;
            const maxX = containerRect.width - buttonWidth - padding;
            const maxY = containerRect.height - buttonHeight - padding;
            
            const randomX = Math.max(padding, Math.random() * maxX);
            const randomY = Math.max(padding, Math.random() * maxY);
            
            noBtnContainer.style.left = randomX + "px";
            noBtnContainer.style.top = randomY + "px";
            noBtnContainer.style.transform = "translate(0, 0)"; // Override centering transform
            
            // Add bounce animation
            noBtnContainer.style.animation = "none";
            setTimeout(() => {
                noBtnContainer.style.animation = "bounce 0.3s ease";
            }, 10);
        }

        function resetYesButton() {
            noClickCount = 0;
            document.getElementById("yesBtn").style.fontSize = "";
            document.getElementById("yesBtn").style.padding = "";
            document.getElementById("question").textContent = "Will you be my Valentine?";
            
            let noBtn = document.getElementById("noBtn");
            noBtn.style.display = "inline-block";
            
            if (noBtnContainer) {
                noBtnContainer.remove();
                noBtnContainer = null;
            }

            // Restore the original gif
            let gifContainer = document.getElementById("gif");
            gifContainer.innerHTML = `<iframe src="https://tenor.com/embed/12962892" width="100%" height="100%" frameborder="0" allowfullscreen></iframe>`;
            gifContainer.style.background = "";
            gifContainer.style.boxShadow = "0 10px 30px rgba(0, 0, 0, 0.2)";
        }

        function setActive(element) {
            document.querySelectorAll(".nav-link").forEach(link => link.classList.remove("active"));
            element.classList.add("active");
        }

        function createConfetti() {
            const colors = ['#ff6b9d', '#c44569', '#f8b500', '#ffa801', '#f85032', '#667eea', '#764ba2'];
            const shapes = ['‚ù§Ô∏è', 'üíï', 'üíú', 'üíñ', '‚≠ê', '‚ú®', 'üéâ'];
            const confettiCount = 150;
            
            for (let i = 0; i < confettiCount; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    
                    // Mix of colored squares and emoji
                    if (Math.random() > 0.5) {
                        confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    } else {
                        confetti.innerHTML = shapes[Math.floor(Math.random() * shapes.length)];
                        confetti.style.fontSize = '20px';
                    }
                    
                    confetti.style.animationDelay = Math.random() * 3 + 's';
                    confetti.style.animationDuration = (Math.random() * 3 + 2) + 's';
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => confetti.remove(), 5000);
                }, i * 20);
            }
        }

        // Floating hearts with sparkles on mouse move
        let lastHeartTime = 0;
        document.addEventListener("mousemove", (event) => {
            const now = Date.now();
            if (now - lastHeartTime > 100) { // Create heart every 100ms
                lastHeartTime = now;
                
                const heart = document.createElement("div");
                heart.classList.add("heart");
                
                // Alternate between different heart styles
                const heartTypes = ['‚ù§Ô∏è', 'üíï', 'üíñ', 'üíó', 'üíì', 'üíù'];
                heart.innerHTML = heartTypes[Math.floor(Math.random() * heartTypes.length)];
                
                document.body.appendChild(heart);
                
                heart.style.left = `${event.clientX}px`;
                heart.style.top = `${event.clientY}px`;
                
                // Add sparkles around the heart
                if (Math.random() > 0.5) {
                    const sparkle = document.createElement("div");
                    sparkle.classList.add("sparkle");
                    sparkle.innerHTML = "‚ú®";
                    sparkle.style.left = `${event.clientX + (Math.random() * 30 - 15)}px`;
                    sparkle.style.top = `${event.clientY + (Math.random() * 30 - 15)}px`;
                    document.body.appendChild(sparkle);
                    
                    setTimeout(() => sparkle.remove(), 1000);
                }
                
                setTimeout(() => {
                    heart.style.opacity = "0";
                    heart.style.transform = "translateY(-80px) scale(1.5) rotate(15deg)";
                }, 10);
                
                setTimeout(() => heart.remove(), 1500);
            }
        });
    </script>
</body>
</html>
